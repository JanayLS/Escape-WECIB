<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fire and Water Game</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }

        #game-container {
            position: absolute;
            width: 100vw;
            height: 100vh;
            background-image: url('wood.jpg');
            overflow: hidden;
            display: block; /* Changed to block to show the game container */
        }

        #start-screen, #color-selection-screen, #pause-screen, #next-level-screen, #final-screen, #secret-path-screen, #journal-screen, #game-over-screen, #congrats-screen, #secret-end-screen, #journal-end-screen, #jumpscare-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        #start-screen button, #color-selection-screen button, #pause-screen button, #next-level-screen button, #final-screen button, #secret-path-screen button, #game-over-screen button, #congrats-screen button, #journal-screen button, #secret-end-screen button, #journal-end-screen button, #jumpscare-screen button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 20px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            background-color: #333;
            color: #fff;
            font-family: 'Creepster', cursive; /* Cursive font for scary effect */
            text-shadow: 2px 2px 4px #000; /* Shadow for scary effect */
        }

        .character {
            position: absolute;
            width: 140px;
            height: 140px;
            border-radius: 30%;
            background-image: url("redplayer.png"); /* Replace with the actual URL for the red player image */
            background-size: cover;
        }

        .water {
            background-image: url("blueplayer.png"); /* Replace with the actual URL for the blue player image */
            background-size: cover;
        }

        .object {
            position: absolute;
            width: 80px;
            height: 80px;
            background: url('notes.png') no-repeat center center / cover;
            border: 1px solid;
        }

        .door {
            position: absolute;
            width: 120px;
            height: 160px;
            background: url('door.png') no-repeat center center / cover;
            border: 1px;
        }

        .boss {
            position: absolute;
            width: 100px;
            height: 100px;
            background: purple url('turbositting.png') no-repeat center center / cover; /* Replace with the actual URL for the purple boss image */
            border: 2px solid #000;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
        }

        .boss.yellow {
            background: yellow url('turbostanding.webp') no-repeat center center / cover; /* Replace with the actual URL for the yellow boss image */
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet"> <!-- Link to Creepster font -->
</head>
<body>
    <div id="game-container">
        <div class="character" id="player"></div>
        <div class="boss" id="boss"></div>
        <div id="level-container"></div>
    </div>

    <div id="secret-end-screen" style="display: none;">
        <h2>Dear Diary</h2>
        <button id="secret-restart-button">Restart</button>
        <button id="secret-exit-button">Exit</button>
    </div>

    <div id="journal-end-screen" style="display: none;">
        <h2>Observation Journal</h2>
        <p>Text for the journal screen goes here.</p>
        <button id="journal-restart-button">Restart</button>
        <button id="journal-exit-button">Exit</button>
    </div>

    <div id="jumpscare-screen" style="display: none;">
        <img id="jumpscare-image" src="" alt="Jumpscare Image" style="width: 100%; height: 100%; object-fit: cover;">
        <button id="jumpscare-restart-button">Restart</button>
        <button id="jumpscare-exit-button">Exit</button>
    </div>

    <script>
        const startScreen = document.getElementById('start-screen');
        const colorSelectionScreen = document.getElementById('color-selection-screen');
        const gameContainer = document.getElementById('game-container');
        const levelIndicator = document.getElementById('level-indicator');
        const playButton = document.getElementById('play-button');
        const exitButton = document.getElementById('exit-button');
        const redButton = document.getElementById('red-button');
        const blueButton = document.getElementById('blue-button');
        const character = document.getElementById('character');
        const levelContainer = document.getElementById('level-container');
        const door = document.createElement('div');
        const note = document.getElementById('note');
        const notesButton = document.getElementById('notes-button');
        const pauseButton = document.getElementById('pause-button');
        const resetButton = document.getElementById('reset-button');
        const notesList = document.getElementById('notes-list');
        const pauseScreen = document.getElementById('pause-screen');
        const nextLevelScreen = document.getElementById('next-level-screen');
        const resumeButton = document.getElementById('resume-button');
        const exitButtonPause = document.getElementById('exit-button-pause');
        const nextLevelConfirmButton = document.getElementById('next-level-confirm-button');
        const exitButtonNextLevel = document.getElementById('exit-button-next-level');
        const finalScreen = document.getElementById('final-screen');
        const finalImage = document.getElementById('final-image');
        const restartButton = document.getElementById('restart-button');
        const secretPathScreen = document.getElementById('secret-path-screen');
        const continueSecretPathButton = document.getElementById('continue-secret-path-button');
        const secretPathTryAgainButton = document.getElementById('secret-path-try-again-button');
        const secretPathExitButton = document.getElementById('secret-path-exit-button');
        const journalScreen = document.getElementById('journal-screen');
        const journalContinueButton = document.getElementById('journal-continue-button');
        const journalTryAgainButton = document.getElementById('journal-try-again-button');
        const journalExitButton = document.getElementById('journal-exit-button');
        const congratsScreen = document.getElementById('congrats-screen');
        const congratsRetryButton = document.getElementById('congrats-retry-button');
        const congratsExitButton = document.getElementById('congrats-exit-button');
        const gameOverScreen = document.getElementById('game-over-screen');
        const tryAgainButton = document.getElementById('try-again-button');
        const restartFromBeginningButton = document.getElementById('restart-from-beginning-button');
        const exitButtonGameOver = document.getElementById('exit-button-game-over');
        const secretEndScreen = document.getElementById('secret-end-screen');
        const secretRestartButton = document.getElementById('secret-restart-button');
        const secretExitButton = document.getElementById('secret-exit-button');
        const journalEndScreen = document.getElementById('journal-end-screen');
        const journalRestartButton = document.getElementById('journal-restart-button');
        const journalEndExitButton = document.getElementById('journal-exit-button'); // Renamed to avoid conflict
        const jumpscareScreen = document.getElementById('jumpscare-screen');
        const jumpscareImage = document.getElementById('jumpscare-image');
        const jumpscareRestartButton = document.getElementById('jumpscare-restart-button');
        const jumpscareExitButton = document.getElementById('jumpscare-exit-button');

        let characterState = 'fire';
        let characterX = 100;
        let characterY = 100;
        let gamePaused = false;
        let collectedNotes = [];
        let currentLevel = 1;
        let bossLooking = false;
        let movementAttempted = false;
        let bossTimeout;
        let bossDurationTimeout;

        const player = document.getElementById('player');
        const boss = document.getElementById('boss');

let playerX = 100;
let playerY = 100;
const playerSpeed = 5;

function updatePlayerPosition() {
    player.style.left = playerX + 'px';
    player.style.top = playerY + 'px';
}

function handleKeyPress(event) {
    if (gamePaused) return;

    switch (event.key) {
        case 'ArrowLeft':
            playerX -= playerSpeed;
            break;
        case 'ArrowRight':
            playerX += playerSpeed;
            break;
        case 'ArrowUp':
            playerY -= playerSpeed;
            break;
        case 'ArrowDown':
            playerY += playerSpeed;
            break;
        case ' ':
            toggleCharacter();
            break;
    }

    // Ensure player stays within screen boundaries
    if (playerX < 0) playerX = 0;
    if (playerX > gameContainer.clientWidth - player.clientWidth) playerX = gameContainer.clientWidth - player.clientWidth;
    if (playerY < 0) playerY = 0;
    if (playerY > gameContainer.clientHeight - player.clientHeight) playerY = gameContainer.clientHeight - player.clientHeight;

    updatePlayerPosition();

    if (bossLooking && event.key !== ' ') {
        movementAttempted = true;
        checkMovementDuringBossLook();
    }
    checkObjectCollision();
    checkDoorCollision();
}

document.addEventListener('keydown', handleKeyPress);

function createRandomObjects(level) {
    levelContainer.innerHTML = '';
    const numberOfObjects = 3;
    const objects = [];

    for (let i = 0; i < numberOfObjects; i++) {
        let object;
        let overlapping;

        do {
            overlapping = false;
            object = {
                element: document.createElement('div'),
                top: Math.random() * (window.innerHeight - 80),
                left: Math.random() * (window.innerWidth - 80)
            };

            // Check for overlap with player
            if (
                Math.abs(object.top - playerY) < 140 &&
                Math.abs(object.left - playerX) < 140
            ) {
                overlapping = true;
            }

            // Check for overlap with other objects
            objects.forEach(existingObject => {
                if (
                    Math.abs(existingObject.top - object.top) < 80 &&
                    Math.abs(existingObject.left - object.left) < 80
                ) {
                    overlapping = true;
                }
            });
        } while (overlapping);

        object.element.classList.add('object');
        object.element.style.top = object.top + 'px';
        object.element.style.left = object.left + 'px';
        levelContainer.appendChild(object.element);
        objects.push(object);
    }

    // Place the door without overlapping objects
    let doorOverlapping;
    do {
        doorOverlapping = false;
        door.style.top = Math.random() * (window.innerHeight - 160) + 'px';
        door.style.left = Math.random() * (window.innerWidth - 120) + 'px';

        objects.forEach(existingObject => {
            const doorRect = door.getBoundingClientRect();
            const objectRect = existingObject.element.getBoundingClientRect();

            if (
                doorRect.left < objectRect.left + objectRect.width &&
                doorRect.left + doorRect.width > objectRect.left &&
                doorRect.top < objectRect.top + objectRect.height &&
                doorRect.top + doorRect.height > objectRect.top
            ) {
                doorOverlapping = true;
            }
        });
    } while (doorOverlapping);

    levelContainer.appendChild(door);
}

function loadLevel(level) {
    characterX = 100;
    characterY = 100;
    updatePlayerPosition();

    createRandomObjects(level);

    door.className = 'door';
    levelContainer.appendChild(door);

    boss.style.background = "purple url('turbositting.png') no-repeat center center / cover"; // Boss starts as purple
    boss.style.right = '10px';
    boss.style.top = '50%';
    boss.style.transform = 'translateY(-50%)';

    levelIndicator.textContent = `Level: ${level}`;

    setTimeout(startBossBehavior, 5000); // Boss is purple for the first 5 seconds
}

function resetCurrentLevelNotes() {
    collectedNotes = collectedNotes.filter(note => !note.includes(`Level ${currentLevel}`));
    notesList.innerHTML = '<h3>Collected Notes</h3><ul>' + collectedNotes.map(note => `<li>${note}</li>`).join('') + '</ul>';
}

resumeButton.addEventListener('click', () => {
    gamePaused = false;
    pauseScreen.style.display = 'none';
});

exitButtonPause.addEventListener('click', () => {
    if (confirm('Are you sure you want to exit?')) {
        window.close();
    }
});

function startBossBehavior() {
    const interval = Math.random() * (20000 - 5000) + 5000; // Random interval between 5-20 seconds
    bossTimeout = setTimeout(() => {
        if (bossLooking) {
            boss.style.background = "purple url('turbositting.png') no-repeat center center / cover"; // Boss looking away
            bossLooking = false;
            startBossBehavior(); // Continue the behavior
        } else {
            boss.style.background = "yellow url('turbostanding.webp') no-repeat center center / cover"; // Boss looking at player
            bossLooking = true;
            movementAttempted = false; // Reset movement attempt
            bossDurationTimeout = setTimeout(() => {
                boss.style.background = "purple url('turbositting.png') no-repeat center center / cover"; // Boss stops looking at player
                bossLooking = false;
                startBossBehavior(); // Continue the behavior
            }, Math.random() * (15000 - 5000) + 5000); // Random duration between 5-15 seconds
        }
    }, interval);
}

function checkMovementDuringBossLook() {
    if (movementAttempted) {
        clearTimeout(bossTimeout);
        clearTimeout(bossDurationTimeout);
        gameOverScreen.style.display = 'flex';
        bossLooking = false;
        document.removeEventListener('keydown', handleKeyPress);
    }
}

function resetGameOverConditions() {
    movementAttempted = false;
    document.addEventListener('keydown', handleKeyPress);
}

function collectNote() {
    collectedNotes.push(`Note from Level ${currentLevel}`);
    notesList.innerHTML = '<h3>Collected Notes</h3><ul>' + collectedNotes.map(note => `<li>${note}</li>`).join('') + '</ul>';
    checkAllNotesCollected();
}

function checkAllNotesCollected() {
    if (collectedNotes.length === 9) {
        if (currentLevel === 3) {
            if (characterState === 'fire') {
                showSecretEnd();
            } else if (characterState === 'water') {
                showJournalEnd();
            }
        }
    }
}

function showSecretEnd() {
    gameContainer.style.display = 'none';
    secretEndScreen.style.display = 'flex';
}

function showJournalEnd() {
    gameContainer.style.display = 'none';
    journalEndScreen.style.display = 'flex';
}

function showJumpscare() {
    gameContainer.style.display = 'none';
    jumpscareScreen.style.display = 'flex';
    jumpscareImage.src = 'jumpscare.png'; // Replace with the actual URL for the jumpscare image
    const audio = new Audio('jumpscare.mp3'); // Replace with the actual URL for the jumpscare sound
    audio.play();
}

secretRestartButton.addEventListener('click', () => {
    window.location.reload();
});

secretExitButton.addEventListener('click', () => {
    window.close();
});

journalRestartButton.addEventListener('click', () => {
    window.location.reload();
});

journalEndExitButton.addEventListener('click', () => {
    window.close();
});

jumpscareRestartButton.addEventListener('click', () => {
    window.location.reload();
});

jumpscareExitButton.addEventListener('click', () => {
    window.close();
});

function checkObjectCollision() {
    const objects = document.querySelectorAll('.object');
    objects.forEach(object => {
        const rect1 = character.getBoundingClientRect();
        const rect2 = object.getBoundingClientRect();

        if (
            rect1.left < rect2.left + rect2.width &&
            rect1.left + rect1.width > rect2.left &&
            rect1.top < rect2.top + rect2.height &&
            rect1.top + rect1.height > rect2.top
        ) {
            object.remove();
            collectNote();
        }
    });
}

function checkDoorCollision() {
    const rect1 = character.getBoundingClientRect();
    const rect2 = door.getBoundingClientRect();

    if (
        rect1.left < rect2.left + rect2.width &&
        rect1.left + rect1.width > rect2.left &&
        rect1.top < rect2.top + rect2.height &&
        rect1.top + rect1.height > rect2.top
    ) {
        if (currentLevel === 3) {
            if (collectedNotes.length === 9) {
                if (characterState === 'fire') {
                    showSecretEnd();
                } else if (characterState === 'water') {
                    showJournalEnd();
                        }
                    } else {
                        if (characterState === 'water') {
                            showJumpscare();
                        } else {
                            alert('Congratulations! You have completed all levels.');
                            window.location.reload();
                        }
                    }
                } else {
                    nextLevelScreen.style.display = 'flex';
                }
            }
        }

        playButton.addEventListener('click', () => {
            startScreen.style.display = 'none';
            colorSelectionScreen.style.display = 'flex';
        });

        exitButton.addEventListener('click', () => {
            alert('Thank you for playing!');
            window.close();
        });

        redButton.addEventListener('click', () => {
            characterState = 'fire';
            character.classList.remove('water');
            character.classList.add('fire');
            startGame();
        });

        blueButton.addEventListener('click', () => {
            characterState = 'water';
            character.classList.remove('fire');
            character.classList.add('water');
            startGame();
        });

        function startGame() {
            colorSelectionScreen.style.display = 'none';
            gameContainer.style.display = 'block';
            loadLevel(currentLevel);
        }

        notesButton.addEventListener('click', () => {
            if (notesList.style.display === 'none') {
                notesList.style.display = 'block';
                notesList.innerHTML = '<h3>Collected Notes</h3><ul>' + collectedNotes.map(note => `<li>${note}</li>`).join('') + '</ul>';
            } else {
                notesList.style.display = 'none';
            }
        });

        pauseButton.addEventListener('click', () => {
            gamePaused = !gamePaused;
            pauseScreen.style.display = gamePaused ? 'flex' : 'none';
        });

        resetButton.addEventListener('click', () => {
            window.location.reload();
        });

        tryAgainButton.addEventListener('click', () => {
            resetCurrentLevelNotes();
            loadLevel(currentLevel);
            gameOverScreen.style.display = 'none';
            resetGameOverConditions();
        });

        exitButtonGameOver.addEventListener('click', () => {
            if (confirm('Are you sure you want to exit?')) {
                window.close();
            }
        });

        nextLevelConfirmButton.addEventListener('click', () => {
            currentLevel++;
            nextLevelScreen.style.display = 'none';
            if (currentLevel <= 3) {
                loadLevel(currentLevel);
            } else {
                if (collectedNotes.length === 9) {
                    if (characterState === 'fire') {
                        showSecretEnd();
                    } else if (characterState === 'water') {
                        showJournalEnd();
                    }
                } else {
                    if (characterState === 'water') {
                        showJumpscare();
                    } else {
                        alert('Congratulations! You have completed all levels.');
                        window.location.reload();
                    }
                }
            }
        });

        exitButtonNextLevel.addEventListener('click', () => {
            if (confirm('Are you sure you want to exit?')) {
                window.close();
            }
        });

        congratsRetryButton.addEventListener('click', () => {
            window.location.reload();
        });

        congratsExitButton.addEventListener('click', () => {
            window.close();
        });

        continueSecretPathButton.addEventListener('click', () => {
            secretPathScreen.style.display = 'none';
            journalScreen.style.display = 'flex';
        });

        secretPathTryAgainButton.addEventListener('click', () => {
            window.location.reload();
        });

        secretPathExitButton.addEventListener('click', () => {
            window.close();
        });

        journalContinueButton.addEventListener('click', () => {
            journalScreen.style.display = 'none';
            startScreen.style.display = 'flex';
        });

        journalTryAgainButton.addEventListener('click', () => {
            window.location.reload();
        });

        journalExitButton.addEventListener('click', () => {
            window.close();
        });

        restartButton.addEventListener('click', () => {
            window.location.reload();
        });

        loadLevel(currentLevel);
        updatePlayerPosition();
    </script>
</body>
</html>